(function(e){function t(t){for(var r,s,o=t[0],c=t[1],u=t[2],l=0,d=[];l<o.length;l++)s=o[l],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&d.push(i[s][0]),i[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);p&&p(t);while(d.length)d.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,s=1;s<n.length;s++){var o=n[s];0!==i[o]&&(r=!1)}r&&(a.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},s={app:0},i={app:0},a=[];function o(e){return c.p+"js/"+({about:"about"}[e]||e)+"."+{about:"ea5468da"}[e]+".js"}function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n={about:1};s[e]?t.push(s[e]):0!==s[e]&&n[e]&&t.push(s[e]=new Promise(function(t,n){for(var r="css/"+({about:"about"}[e]||e)+"."+{about:"1ef20c35"}[e]+".css",i=c.p+r,a=document.getElementsByTagName("link"),o=0;o<a.length;o++){var u=a[o],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===r||l===i))return t()}var d=document.getElementsByTagName("style");for(o=0;o<d.length;o++){u=d[o],l=u.getAttribute("data-href");if(l===r||l===i)return t()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=t,p.onerror=function(t){var r=t&&t.target&&t.target.src||i,a=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");a.code="CSS_CHUNK_LOAD_FAILED",a.request=r,delete s[e],p.parentNode.removeChild(p),n(a)},p.href=i;var v=document.getElementsByTagName("head")[0];v.appendChild(p)}).then(function(){s[e]=0}));var r=i[e];if(0!==r)if(r)t.push(r[2]);else{var a=new Promise(function(t,n){r=i[e]=[t,n]});t.push(r[2]=a);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=o(e);var d=new Error;u=function(t){l.onerror=l.onload=null,clearTimeout(p);var n=i[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+r+": "+s+")",d.name="ChunkLoadError",d.type=r,d.request=s,n[1](d)}i[e]=void 0}};var p=setTimeout(function(){u({type:"timeout",target:l})},12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(t)},c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="",c.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=t,u=u.slice();for(var d=0;d<u.length;d++)t(u[d]);var p=l;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"189d":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var r=n("fa12");class s extends r["a"]{constructor(e){super(e,{icon:"fas fa-globe",name:"Online Storage",info:{description:"Saves the universe to your online Lorebrary account.",good:["Syncs across machines and workspaces","Live collaboration tools"],bad:["Storage size is subscription based"]}})}isEnabled(){return!1}async init(){throw new Error("No credentials.")}isAccessible(){return!1}}},"482c":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var r=n("fa12");class s extends r["a"]{constructor(e){super(e,{icon:"fab fa-google-drive",name:"Google Drive",info:{description:"Saves the universe to a database in google drive.",good:["Syncs across machines and workspaces"],bad:["No live collaboration tools","May run in to sync issues"]}})}isEnabled(){return!1}async init(){}isAccessible(){return!1}}},"56d7":function(e,t,n){"use strict";n.r(t);var r=n("2b0e"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.$store.state.startup.is?n("div",{attrs:{id:"main-loader"}},[e._m(0),n("div",{attrs:{id:"text"}},e._l(e.$store.state.startup.stages,function(e,t){return n("span",{key:t,class:"dot"+(e.status?" "+e.status:"")})}),0)]):n("router-view")},i=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"loader"},[n("span",{staticClass:"loader-inner"})])}],a={mounted(){try{this.$store.state.window.frame=window.self!==window.top}catch(e){this.$store.state.window.frame=!0}this.$store.state.window.frame||this.$store.dispatch("doStartup")}},o=a,c=n("2877"),u=Object(c["a"])(o,s,i,!1,null,null,null),l=u.exports,d=n("8c4f");r["a"].use(d["a"]);var p=new d["a"]({base:"",routes:[{path:"/",component:()=>n.e("about").then(n.bind(null,"6b61")),children:[{path:"search",name:"Global Search",component:()=>n.e("about").then(n.bind(null,"2d3b"))},{path:"notes/:noteId?",name:"Global Notes",component:()=>n.e("about").then(n.bind(null,"0841"))},{path:"",name:"Dashboard",component:()=>n.e("about").then(n.bind(null,"f021"))},{path:"account",name:"Account",component:()=>n.e("about").then(n.bind(null,"029e"))}]},{path:"/universes/:universe",component:()=>n.e("about").then(n.bind(null,"29e4")),children:[{path:"search",name:"Search",component:()=>n.e("about").then(n.bind(null,"2d3b"))},{path:"notes/:noteId?",name:"Notes",component:()=>n.e("about").then(n.bind(null,"0841"))},{path:"",name:"Overview",component:()=>n.e("about").then(n.bind(null,"5ee7"))},{path:"codex",name:"Codex",meta:{darkAppBar:!0},component:()=>n.e("about").then(n.bind(null,"519c"))},{path:"maps",name:"Atlas",component:()=>n.e("about").then(n.bind(null,"5ee7"))},{path:"timelines",name:"Timelines",component:()=>n.e("about").then(n.bind(null,"5ee7"))},{path:"stories",name:"Stories",component:()=>n.e("about").then(n.bind(null,"5ee7"))},{path:"resources",component:()=>n.e("about").then(n.bind(null,"4cf2")),children:[{path:"categories",name:"Categories",component:()=>n.e("about").then(n.bind(null,"5ee7"))},{path:"images",name:"Images",component:()=>n.e("about").then(n.bind(null,"5ee7"))},{path:"templates",name:"Templates",component:()=>n.e("about").then(n.bind(null,"5ee7"))}]},{path:"settings",component:()=>n.e("about").then(n.bind(null,"4cf2")),children:[{path:"collaborators",name:"Collaborators",component:()=>n.e("about").then(n.bind(null,"5ee7"))},{path:"followers",name:"Followers",component:()=>n.e("about").then(n.bind(null,"5ee7"))},{path:"settings",name:"Settings",component:()=>n.e("about").then(n.bind(null,"5ee7"))}]}]}]}),v=n("2f62"),f=n("11c1"),h=n.n(f),m=n("fa12");r["a"].use(v["a"]);var b=new v["a"].Store({state:{window:{frame:!1,miniDrawer:!0},startup:{is:!0,stages:{}},universes:null,universeLoading:!1,universeSelected:null},getters:{universeList(e){if(!e.universes)throw new Error("Universe list is null!");return Object.values(e.universes)},universe(e){if(!e.universes)throw new Error("No universe selected!");return e.universes[e.universeSelected]},driver(e,t){if(!t.universe)throw new Error("Attempted to access the driver of an invalid universe!");if(!t.universe.driver)throw new Error("Attempted to access the driver of a universe with no driver!");return m["c"][t.universe.driver]}},mutations:{setStartupStage(e,[t,n]){r["a"].set(e.startup.stages,t,n)},setUniverses(e,t){e.universes=t},setUniverse(e,t){r["a"].set(e.universes,t.id,t),e.universeSelected=t.id},setCurrentUniverse(e,t){e.universeSelected=t?t.id:null}},actions:{async doStartup(e){await g(e)},async loadUniverses({commit:e}){let t=[],n={};for(let[r,s]of Object.entries(m["c"]))s.isEnabled()&&t.push(s.getStore().getUniverses().then(e=>{for(let t of e)t.driver=r,n[t.id]={driver:r,id:t.id,name:t.name,description:t.description}}));await Promise.all(t),e("setUniverses",n)},async loadUniverse({commit:e,state:t},n){if(t.universeSelected==n)return;let r=n?t.universes[n]:null,s=r?m["c"][r.driver]:null;if(!s)return void(t.universeSelected=null);t.universeLoading=!0;let i=await s.getStore().getUniverse(n);e("setCurrentUniverse",i),t.universeLoading=!1},async saveUniverse({commit:e,getters:t},n){n.id||(n.id=h.a.v4()),e("setUniverse",n),await t.driver.getStore().saveUniverse(n.id,{id:n.id,name:n.name,description:n.description})},async getArticlesOfType({commit:e,state:t,getters:n},r){return r=r||{},await n.driver.getStore().getArticlesOfType(t.universeSelected,r)},async getArticle({commit:e,state:t,getters:n},r){return r=r||{},await n.driver.getStore().getArticle(t.universeSelected,r)},async saveArticle({commit:e,state:t,getters:n},r){r.id||(r.id=h.a.v4()),await n.driver.getStore().saveArticle(t.universeSelected,{id:r.id,type:r.type,parent:r.parent,icon:r.icon,name:r.name,tags:r.tags,content:r.content})},async deleteArticle({commit:e,state:t,getters:n},r){r=r||{},await n.driver.getStore().deleteArticle(t.universeSelected,r)}}});async function g({dispatch:e,commit:t,state:n}){for(let[s,i]of Object.entries(m["c"]))i.isEnabled()&&t("setStartupStage",["driver-"+s,{status:null}]);for(let[s,i]of Object.entries(m["c"]))if(i.isEnabled())try{await i.init(),t("setStartupStage",["driver-"+s,{status:"done"}])}catch(r){t("setStartupStage",["driver-"+s,{status:"error"}])}await e("loadUniverses"),n.startup.is=!1}var y=n("f309");n("7adb");r["a"].use(y["a"]);var w=new y["a"]({icons:{iconfont:"fa"},theme:{dark:!1,themes:{light:{secondary:"#424242",accent:"#82B1FF",error:"#FF5252",info:"#2196F3",success:"#4CAF50",warning:"#FFC107"},dark:{primary:"#FFF"}}}});n("d5e8"),n("15f5");let S=null;function A(e,t){S&&(void 0===t&&(t=null),S.postMessage(JSON.stringify({type:e,payload:t}),"*"))}let E={isReady(e){return{type:"ready",payload:!0}},doStartup(){b.dispatch("doStartup")},isStartedUp(){return!b.state.startup.is}};window.addEventListener("message",e=>{if(!e.origin.startsWith("file://"))return;S=e.source;let{type:t,payload:n}=JSON.parse(e.data);if(E.hasOwnProperty(t)){let e=E[t](n);e&&(e.type?A(e.type,e.payload):A(t,e))}}),r["a"].config.productionTip=!1,r["a"].prototype.$drivers=m["c"],new r["a"]({router:p,store:b,vuetify:w,render:function(e){return e(l)}}).$mount("#app")},6354:function(e,t,n){"use strict";n.r(t),n.d(t,"BrowserStore",function(){return a}),n.d(t,"default",function(){return o});var r=n("fa12");const s=n("0dff");function i(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}class a extends r["b"]{constructor(){super(),this.universes=new s("universes"),this.articles=new s("articles")}async init(){this.universes.loadDatabase(),this.articles.loadDatabase()}getUniverses(){return new Promise(e=>this.universes.find({},(t,n)=>e(n)))}getUniverse(e){return new Promise(e=>this.universes.findOne({},(t,n)=>e(n)))}async saveUniverse(e,t){this.universes.update({id:e},t,{upsert:!0})}async deleteUniverse(e){this.universes.remove({id:e})}async getArticlesOfType(e,t){return void 0!==t.search&&(t.name=new RegExp(i(t.search),"gi"),delete t.search),new Promise(n=>{this.articles.find({universe:e,...t},(e,t)=>n(t))})}async getArticles(e,t){return void 0!==t.search&&(t.name=new RegExp(i(t.search),"gi"),delete t.search),new Promise(n=>{this.articles.find({universe:e,...t},(e,t)=>{let r={};for(let n of t)r[n.id]=n;this.articles.find({$or:t.map(e=>({parent:e.id}))},{parent:1},(e,s)=>{for(let t of s)r[t.parent].children||(r[t.parent].children=[]);n(t)})})})}async getArticle(e,t){return new Promise(n=>this.articles.findOne({universe:e,id:t},(e,t)=>n(t)))}async saveArticle(e,t){this.articles.update({universe:e,id:t.id},{universe:e,...t},{upsert:!0})}async deleteArticle(e,t){if(t.retainChildren){let n=await this.getArticle(t.id);this.articles.remove({universe:e,id:t.id}),this.articles.update({universe:e,parent:t.id},{$set:{parent:n.parent}},{upsert:!0})}else{let n=[],r=await this.getArticles(e,t.id);for(let t of r)n.push(await this.deleteArticle(e,{id:t.id,retainChildren:!1}));this.articles.remove({universe:e,id:t.id}),await Promise.all(n)}}}class o extends r["a"]{constructor(e){super(e,{icon:"fas fa-sticky-note",name:"Local Storage",info:{description:"Saves the universe to a your browser's local storage.",good:["No storage limit (with permission)"],bad:["No live collaboration tools","Might not persist across sessions"]}}),this.store=new a}isEnabled(){return!0}async init(){await this.store.init()}isAccessible(){return!0}}},"7adb":function(e,t,n){},8862:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var r=n("fa12");class s extends r["a"]{constructor(e){super(e,{icon:"fab fa-dropbox",name:"Dropbox",info:{description:"Saves the universe to a database in dropbox.",good:["Syncs across machines and workspaces"],bad:["No live collaboration tools","May run in to sync issues","Little storage available"]}})}isEnabled(){return!1}async init(){}isAccessible(){return!1}}},bd2b:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var r=n("fa12");class s extends r["a"]{constructor(e){super(e,{icon:"fas fa-hdd",name:"Hard Drive",info:{description:"Saves the universe to your hard drive.",good:["No storage limit"],bad:["No live collaboration tools"]}})}isEnabled(){return!1}async init(){}isAccessible(){return!1}}},fa12:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return i});const r=new Proxy({},{get(e,t){return new Promise(()=>{throw new Error("Unsupported store function '"+t+"'")})}});class s{constructor(e,t){this.id=e,this.icon=t.icon,this.name=t.name,this.info=t.info,this.store=t.store||r,this.capabilities={}}getStore(){return this.store}getCapabilities(){return this.capabilities}getCapability(e){return this.capabilities[e]}isEnabled(){return!1}async init(){}isAccessible(){return!1}}class i{async getUniverses(){return[]}async getUniverse(e){return null}async saveUniverse(e,t){}async deleteUniverse(e){}async getArticlesOfType(e,t){return null}async getArticles(e,t){return null}async getArticle(e,t){return null}async saveArticle(e,t){}async deleteArticle(e,t){}}t["c"]={online:new(n("189d").default)("online"),google:new(n("482c").default)("google"),dropbox:new(n("8862").default)("dropbox"),drive:new(n("bd2b").default)("drive"),browser:new(n("6354").default)("browser")}}});
//# sourceMappingURL=app.92756830.js.map